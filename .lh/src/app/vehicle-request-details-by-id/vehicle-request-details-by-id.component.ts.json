{
    "sourceFile": "src/app/vehicle-request-details-by-id/vehicle-request-details-by-id.component.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1712238606196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1712238606196,
            "name": "Commit-0",
            "content": "import { Component, OnInit } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Overlay, OverlayRef } from '@angular/cdk/overlay';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { NgxSpinnerService } from 'ngx-spinner';\r\nimport { ToastrService } from 'ngx-toastr';\r\n\r\nimport * as fileSaver from 'file-saver';\r\nimport { saveAs as importedSaveAs } from \"file-saver\";\r\nimport { image, json } from '@rxweb/reactive-form-validators';\r\n\r\nimport { environment } from 'src/environments/environment';\r\nimport { FormGroup, FormControl, Validators, FormBuilder } from '@angular/forms';\r\nimport { AuthTokenService } from 'src/app/login/auth-token.service';\r\nimport { getVehicleOut } from 'src/app/Model/getvehicleOut';\r\nimport { ComponentPortal } from '@angular/cdk/portal';\r\nimport { ProgressContainerComponentComponent } from '../progress-container-component/progress-container-component.component';\r\n@Component({\r\n  selector: 'app-vehicle-request-details-by-id',\r\n  templateUrl: './vehicle-request-details-by-id.component.html',\r\n  styleUrls: ['./vehicle-request-details-by-id.component.css']\r\n})\r\nexport class VehicleRequestDetailsByIdComponent implements OnInit {\r\n  id:number;\r\n  activeradio:string;\r\n  overlayRef:any;\r\n  VehicleList:any;\r\n  remarkvalue:any;\r\n  roletype:any;\r\n  getvehicleout:any;\r\n  response_api:any;\r\n  HODApproval:any;\r\n  AdminRequest:any;\r\n  myFormControl = new FormControl('');\r\n  constructor( public authTokenService: AuthTokenService, private http: HttpClient ,private spinner: NgxSpinnerService, private toastr: ToastrService,private router: Router,private route: ActivatedRoute,private formbuilder : FormBuilder,\r\n   \r\n    private overlay: Overlay,) {\r\n    }\r\n\r\n    remarkformvalue:String; \r\n  ngOnInit(): void {\r\n    this.id= this.route.snapshot.params['id'];\r\n    this.activeradio= this.route.snapshot.params['activeradio'];\r\n    \r\n    this.HODApproval= this.route.snapshot.params['HODApproval'];\r\n    this.AdminRequest= this.route.snapshot.params['AdminRequest'];\r\n\r\nconsole.log(\"HODApproval  \"+this.HODApproval);\r\n    this.getuserrole()\r\n    this.getVehicleRequestById();\r\n   // this.getvehicleout=new getVehicleOut();\r\n\r\n  }\r\n  getuserrole()\r\n  { \r\n   \r\n    this.roletype=this.authTokenService.getUserRole();\r\n    return this.authTokenService.getUserRole();\r\n  }\r\n  getHODrole()\r\n  {\r\n    if(this.roletype == 'HOD')\r\n    {\r\n      return true;\r\n    }\r\n    else{\r\n      return false;\r\n    }\r\n  }\r\n  getAdminrole()\r\n  {\r\n    \r\n    \r\n    if(this.roletype == 'VPADM')\r\n    {\r\n      return true;\r\n    }\r\n    else{\r\n      return false;\r\n    }\r\n  }\r\n\r\n  getVpolManagerRole()\r\n  {\r\n    \r\n    \r\n    if(this.roletype == 'VMANG')\r\n    {\r\n      return true;\r\n    }\r\n    else{\r\n      return false;\r\n    }\r\n  }\r\n\r\n  myFunc()\r\n  {\r\n\r\n    \r\n    // https://appdev.prismcement.com/vpoolqas/ApprovalControllers/SelfRejectVPool\r\n  }\r\n  getUserRole()\r\n  {\r\n   \r\n    if(this.roletype == 'User')\r\n    {\r\n       return true; \r\n    }\r\n    else{\r\n      return false;\r\n    }\r\n  }\r\n\r\n  getVehicleRequestById(){\r\n\r\n    return this.http.get(environment.apiurl+'AllApplication/getVehicleRequisitionById/' + this.id)\r\n    .subscribe(response => {\r\n     this.VehicleList=response;\r\n       console.log(\"Success data\");\r\n       console.log(this.VehicleList);\r\n  });\r\n  }\r\n\r\n  postVehicleRequest(req_status ){\r\n    this.spinner.show();\r\n   this. showOverlay();\r\n   console.log(\"DATA\");\r\n    // console.log(document.getElementById('remarkformvalue'));\r\n\r\n    return this.http.post<any>(environment.apiurl + 'ApprovalControllers/ApproveRejectVPoolHODVpoolAdmin', {\r\n      \"appFor\": req_status,\r\n      \"appId\": this.id,\r\n      \"remark\":  this.myFormControl.value\r\n    })\r\n   .subscribe(response => {\r\n    this.spinner.hide();\r\n   this. hideOverlay();\r\n   this.response_api=response;\r\n   console.log('message2112212'+this.response_api.message);\r\n\r\n \r\n  \r\n    this.toastr.success('Request ' +req_status+ ' Successfully')\r\n  \r\n   if(this.getHODrole()){\r\n    console.log('hod Role' );\r\n    this.router.navigate(['/vehicleappravalhodlist']);\r\n   }\r\n   if(this.getVpolManagerRole()){\r\n    console.log('Vpool Admin Role' );\r\n    this.router.navigate(['/vehiclerequestdetals']);\r\n   }\r\n   \r\n    else if(this.getAdminrole()){\r\n     this.router.navigate(['/VoolAdminRequestList']);\r\n\r\n    }\r\n   });\r\n}\r\n\r\nadminVehicleApprove(req_status ){\r\n   this. showOverlay();\r\n   console.log(\"DATA\");\r\n    // console.log(document.getElementById('remarkformvalue'));\r\n\r\n    return this.http.post<any>(environment.apiurl + '', {\r\n      \"appFor\": req_status,\r\n      \"appId\": this.id,\r\n      \"remark\":  this.myFormControl.value\r\n    })\r\n   .subscribe(response => {\r\n    \r\n   this. hideOverlay();\r\n   this.response_api=response;\r\n   console.log(this.response_api);\r\n    if(this.getHODrole){\r\n    this.router.navigate(['/vehicleappravalhodlist']);\r\n   }\r\n    else if(this.getAdminrole){\r\n     this.router.navigate(['/VoolAdminRequestList']);\r\n\r\n    }\r\n    \r\n   });\r\n}\r\n\r\nselfCancle(req_status ){\r\n   this. showOverlay();\r\n   console.log(\"DATA\");\r\n    // console.log(document.getElementById('remarkformvalue'));\r\n\r\n    return this.http.post<any>(environment.apiurl + 'ApprovalControllers/SelfRejectVPool', {\r\n      \"appFor\": req_status,\r\n      \"appId\": this.id,\r\n      \"remark\": this.myFormControl.value\r\n    })\r\n   .subscribe(response => {\r\n    \r\n   this. hideOverlay();\r\n   this.response_api=response;\r\n   console.log(this.response_api);\r\n   if(this.getUserRole){\r\n    \r\n    this.router.navigate(['/vehiclerequestdetals']);\r\n   }\r\n   });\r\n}\r\n hideOverlay() {\r\n  if (this.overlayRef) {\r\n    this.overlayRef.detach();\r\n    this.overlayRef.dispose();\r\n  }\r\n}\r\nshowOverlay() {\r\n  this.overlayRef = this.overlay.create({\r\n    positionStrategy: this.overlay\r\n      .position()\r\n      .global()\r\n      .centerHorizontally()\r\n      .centerVertically(),\r\n    hasBackdrop: true,\r\n  });\r\n  this.overlayRef.attach(new ComponentPortal(ProgressContainerComponentComponent));\r\n}\r\n\r\n}\r\n"
        }
    ]
}